<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Add Entry</title>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.css">
    <link rel="stylesheet" type="text/css" media="screen" href="main.css" />
    <link rel="stylesheet" type="text/css" media="screen" href="createNew.css" />
    <script src="http://js.api.here.com/v3/3.0/mapsjs-core.js" type="text/javascript" charset="utf-8"></script>
    <script src="http://js.api.here.com/v3/3.0/mapsjs-service.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript" src="coordinatesService.js"></script>
  </head>
  <body>
    <div>
    <form id="form-id"
      action='http://localhost:3000/api/create'
      method='post'
      encType="multipart/form-data">
      <input type="file" name="image" accept="image/*" required><br>
    <input type="hidden" name="lat" id="lat"/>
    <input type="hidden" name="lng" id="lng"/>
    <textarea name="address" id="address" onchange="invalidate()"></textarea><br>
    <div id="addressValidator" style="width: 150px; height: 50px; margin: auto auto" onclick="validateAddress()">validate Address</div><br>
    <textarea name="description" required></textarea><br>

    <input id="submitbtn" style="color: red" type="submit" value="submit" disabled/>
  </form>

</div>
  </body>
  <script type="text/javascript">
    var isFormValid = false;

    function validateAddress(){
      var address = document.getElementById("address");
      geocode(address.value, function(result) {
        try {
          console.log(result)
          var locations = result.response.view[0].result;
          var lat = locations[0].location.displayPosition.latitude;
          var lng = locations[0].location.displayPosition.longitude;

          document.getElementById("lat").value = lat;
          document.getElementById("lng").value = lng;

          console.log("lat: " + lat + " lng: " + lng);
          isFormValid = true
          document.getElementById("submitbtn").disabled = false;
          document.getElementById("submitbtn").style.color = "black";
        } catch (err) {

        }
      });
    }

    function invalidate(){
      isFormValid = false;
      document.getElementById("submitbtn").disabled = true;
      document.getElementById("submitbtn").style.color = "red";
    }
</script>
</html>
